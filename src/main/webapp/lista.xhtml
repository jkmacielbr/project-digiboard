<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core" xml:lang="en">
<h:head>
    <title>Lista de Pessoas</title>
</h:head>
<h:body>
    <h:form>

        <p:menubar>
            <p:menuitem value="Início" icon="pi pi-fw pi-search" outcome="index.xhtml"/>
            <p:menuitem value="Cadastro" icon="pi pi-fw pi-plus" outcome="create.xhtml"/>
            <p:menuitem value="Consulta" icon="pi pi-fw pi-search" outcome="lista.xhtml"/>
        </p:menubar>
        <p:growl id="messages" showDetail="true"/>
        <p:dataTable id="peopleTable" var="person" value="#{peopleBean.listAll()}"
                     emptyMessage="Nenhum registro encontrado"
                     paginator="true" rows="10" paginatorPosition="bottom"
                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}">
            <f:facet name="header">
                <p:outputPanel>
                    <h:outputLabel for="globalFilter"/>
                    <p:inputText id="globalFilter" value="#{peopleBean.searchString}" style="width:300px"
                                 placeholder="Pesquisar por nome ou sobrenome">
                        <p:ajax event="keyup" listener="#{peopleBean.filterPeople}" update="peopleTable"/>
                    </p:inputText>

                </p:outputPanel>

            </f:facet>

            <p:column width="5" style="text-align: center" headerText="Id">
                <h:outputText value="#{person.id}"/>
            </p:column>
            <p:column width="20" style="text-align: center" headerText="Nome">
                <h:outputText value="#{person.firstName}"/>
            </p:column>
            <p:column width="20" style="text-align: center" headerText="Sobrenome">
                <h:outputText value="#{person.lastName}"/>
            </p:column>
            <p:column width="10" style="text-align: center" headerText="Data de Aniversário">
                <h:outputText value="#{peopleBean.getFormattedDate(person.dateBirth)}"/>
            </p:column>
            <p:column width="10" style="text-align: center" headerText="Endereço">
                <p:commandButton value="Exibir Endereço" onclick="PF('enderecoDialog#{person.id}').show()"
                                 type="button"/>
                <p:dialog header="Endereço de #{person.firstName}" widgetVar="enderecoDialog#{person.id}" modal="true">
                    <b>Logradouro: </b>#{person.address.street} <br/>
                    <b>Número: </b>#{person.address.numberHouse}<br/>
                    <b>Bairro: </b>#{person.address.neighborhood}<br/>
                    <b>Cidade: </b>#{person.address.city}<br/>
                    <b>Estado: </b>#{person.address.state}<br/>
                    <b>País: </b>#{person.address.country}<br/>

                </p:dialog>
            </p:column>

            <p:column width="5" style="text-align: center" headerText="Ações">
                <p:commandButton value="Editar" onclick="PF('editDialog#{person.id}').show()" type="button"/>
                <p:commandButton value="Excluir" action="#{peopleBean.deletePerson(person.id)}"
                                 oncomplete="PF('deleteDialog#{person.id}').hide()"
                                 ajax="true"/>

                <p:dialog header="Editar Pessoa" widgetVar="editDialog#{person.id}" modal="true">
                    <h:form>
                        <p:panelGrid columns="2" cellpadding="5" styleClass="no-border">

                            <h:outputLabel for="firstName" value="Nome:" immediate="true"/>
                            <p:inputText id="firstName" value="#{person.firstName}"/>


                            <h:outputLabel for="lastName" value="Sobrenome:"/>
                            <p:inputText id="lastName" value="#{person.lastName}" immediate="true"/>

                            <h:outputLabel for="dateBirth" value="Data de Aniversário:"/>
                            <p:calendar id="dateBirth" value="#{person.dateBirth}" immediate="true"/>

                            <h:outputLabel for="street" value="Rua:"/>
                            <p:inputText id="street" value="#{person.address.street}" immediate="true"/>

                            <h:outputLabel for="number" value="Número:"/>
                            <p:inputText id="number" value="#{person.address.numberHouse}" immediate="true"/>

                            <h:outputLabel for="neighborhood" value="Bairro:"/>
                            <p:inputText id="neighborhood" value="#{person.address.neighborhood}" immediate="true"/>

                            <h:outputLabel for="city" value="Cidade:"/>
                            <p:inputText id="city" value="#{person.address.city}" immediate="true"/>

                            <h:outputLabel for="state" value="Estado:"/>
                            <p:inputText id="state" value="#{person.address.state}" immediate="true"/>

                            <h:outputLabel for="country" value="País:"/>
                            <p:inputText id="country" value="#{person.address.country}" immediate="true"/>


                            <!-- Adicione aqui outros campos para editar as informações da pessoa -->

                        </p:panelGrid>

                        <div class="text-right">
                            <p:commandButton value="Salvar" action="#{peopleBean.updatePerson(person)}"
                                             oncomplete="PF('editDialog#{person.id}').hide()"
                                             process="@form"
                                             ajax="true"/>
                            <p:commandButton value="Cancelar" onclick="PF('editDialog#{person.id}').hide();"
                                             ajax="true"/>
                        </div>
                    </h:form>
                </p:dialog>
            </p:column>

        </p:dataTable>
    </h:form>


</h:body>
</html>
